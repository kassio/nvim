#!/usr/bin/env bash

function all_rubies_do() {
  for rb in `rbenv versions --bare`
  do
    export RBENV_VERSION=${rb}
    echo "with ruby: $(rbenv version-name)"
    eval "$@"
  done

  unset RBENV_VERSION
}

function install_or_update_gem() {
  if [ "$(gem search -i $1)" == "false" ]
  then
    echo "Installing $1"
    all_rubies_do gem install $1 --quiet
  else
    echo "Updating $1"
    all_rubies_do gem update $1 --quiet
  fi
}

brew install lua >/dev/null

pip install --force-reinstall neovim
pip3 install --force-reinstall neovim-remote

install_or_update_gem neovim
install_or_update_gem rcodetools
