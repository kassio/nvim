#!/usr/bin/env bash

plug="$HOME/.local/share/nvim/site/autoload/plug.vim"
plugin="$HOME/.config/nvim/plugin.vim"

__nvim() {
  nvim --noplugin -u $plugin "$@"
}

__pack() {
  local cmd
  case "$1" in
    -u | --update)
      __nvim +"PlugUpgrade | PlugClean! | PlugUpdate!" \
        +"CocUpdateSync" \
        +"qall!"
        ;;
    *)
      __nvim +"PlugUpgrade | PlugInstall! | CocUpdateSync" +"qall!"
        ;;
  esac
}

if [ ! -f "${plug}" ]; then
  curl -sfLo "${plug}" --create-dirs \
    https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
fi

__pack "$@"
